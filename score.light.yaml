apiVersion: score.dev/v1b1
metadata:
  name: backstage
  annotations:
    tags: "nodejs,javascript,html,css,website"
containers:
  backstage:
    image: .
    command:
      - "node"
    args:
      - packages/backend
      - "--config"
      - app-config.yaml
      - "--config"
      - app-config.production.yaml
    variables:
      APP_CONFIG_backend_database_client: "better-sqlite3"
      APP_CONFIG_backend_database_connection: ":memory:"
      APP_CONFIG_auth_providers_guest_dangerouslyAllowOutsideDevelopment: "true"
      APP_CONFIG_app_baseUrl: http://localhost:3000
      APP_CONFIG_backend_baseUrl: http://localhost:7007
      APP_CONFIG_backend_cors_origin: http://localhost:3000
      APP_CONFIG_techRadar_url: https://github.com/mathieu-benoit/humanitec-ref-arch/blob/main/tech-radar.json
    volumes:
      /tmp:
        source: ${resources.tmp-dir}
        readOnly: false
service:
  ports:
    tcp:
      port: 7007
      targetPort: 7007
resources:
  tmp-dir:
    type: volume
